import pefile
import sys


def GetFileHeader(pe):
    for field in pe.DOS_HEADER.dump():
        print(field)

# list all imports
def GetFileImports(pe):
    print("[*] Listing imported DLLs...")
    for entry in pe.DIRECTORY_ENTRY_IMPORT:
        print('\t' + entry.dll.decode('utf-8'))

# list data sizes 
def GetDataSizes(pe):
    for data_dir in pe.OPTIONAL_HEADER.DATA_DIRECTORY:
        print(data_dir)


# list all sections
def GetAllFileSections(pe):
    for section in pe.sections:
        print(section.Name.decode('utf-8'))
        print("\tVirtual Address: " + hex(section.VirtualAddress))
        print("\tVirtual Size: " + hex(section.Misc_VirtualSize))
        print("\tRaw Size: " + hex(section.SizeOfRawData))

def main(args):
    
    pe = pefile.PE(str(args))
    GetAllFileSections(pe)
    GetDataSizes(pe)
    GetFileImports(pe)
    GetFileHeader(pe)
    #resourse_entries = [entry.id for entry in pe.DIRECTORY_ENTRY_RESOURCE.entries]


if __name__ == "__main__":
    print(sys.argv[1])
    if (len(sys.argv) > 1) and (len(sys.argv) < 3):
        main(sys.argv[1])

    
    
