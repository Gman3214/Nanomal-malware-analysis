import yara
from os import listdir
from os.path import isfile, join

def main():
    target_dir = "yararules/"

    files = [f for f in listdir(target_dir) if isfile(join(target_dir, f))]
    
    rules = {}

    num = 0
    for file in files:
        rules["rule" + str(num)] = target_dir + file
        num += 1
        


    rule = yara.compile(filepaths=rules)
    matchs = rule.match("strings.txt")
    

    for match in matchs:
        print("-------------------------------------------------------")
        print(match)
        print("strings found :")
        print(match.strings)

    #print(matchs)


if (__name__ == "__main__"):
    main()